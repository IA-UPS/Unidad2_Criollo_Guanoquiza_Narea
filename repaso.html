<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Katherine Criollo, Christian Guanoquiza, Esteban Narea">

<title>Predicción de la diabetes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="repaso_files/libs/clipboard/clipboard.min.js"></script>
<script src="repaso_files/libs/quarto-html/quarto.js"></script>
<script src="repaso_files/libs/quarto-html/popper.min.js"></script>
<script src="repaso_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="repaso_files/libs/quarto-html/anchor.min.js"></script>
<link href="repaso_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="repaso_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="repaso_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="repaso_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="repaso_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicción de la diabetes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Katherine Criollo, Christian Guanoquiza, Esteban Narea </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="intro" class="level1">
<h1>Intro</h1>
<p>Este sería un ejemplo de examen El siguiente conjunto de datos, consuste en predecir a pacientes basandonos en datos clínicos, si puede padecer diabetes o no.</p>
<p>Antes de cualquier método de clasificación, regresión o lo que sea, necesitamos explorar los datos.</p>
<p>Esto supone exámenes estadísticos inferenciales univariantes, bivariantes y multivariantes.</p>
</section>
<section id="pima-indians-diabetes-database" class="level1">
<h1>Pima Indians Diabetes Database</h1>
<p>This dataset is originally from the National Institute of Diabetes and Digestive and Kidney Diseases. The objective of the dataset is to diagnostically predict whether or not a patient has diabetes, based on certain diagnostic measurements included in the dataset. Several constraints were placed on the selection of these instances from a larger database. In particular, all patients here are females at least 21 years old of Pima Indian heritage.</p>
</section>
<section id="cargamos-librerias" class="level1">
<h1>Cargamos librerias</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>You can cite this package as:
     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.
     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167</code></pre>
</div>
</div>
</section>
<section id="cargamos-los-datos" class="level1">
<h1>Cargamos los datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)<span class="co">#en esta sección s ecargan los datos del archivo CVS y se almacena en la variable llamada datos. </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)<span class="co">#Este comando sirve para mostrar la primera fila de la columna de datos cargados con el objetivo de tener una vista previa rápida de los datos para verificar su estructura y contenido. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies Glucose BloodPressure SkinThickness Insulin  BMI
1           6     148            72            35       0 33.6
2           1      85            66            29       0 26.6
3           8     183            64             0       0 23.3
4           1      89            66            23      94 28.1
5           0     137            40            35     168 43.1
6           5     116            74             0       0 25.6
  DiabetesPedigreeFunction Age Outcome
1                    0.627  50       1
2                    0.351  31       0
3                    0.672  32       1
4                    0.167  21       0
5                    2.288  33       1
6                    0.201  30       0</code></pre>
</div>
</div>
<p>Si echamos una búsqueda rápida en google, observamos que el pedigree, es eso, la historia familiar de diabetes. Por lo tanto, aquí podríamso hacer varias cosas ! Entre ellas, regresar los datos a dicha función, o clasificar según esta variable, considerarla o no considerarla.</p>
<p>Para empezar vamos a considerarla para ver la clasificación del modelo knn y bayes.</p>
<section id="miramos-las-clases-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="miramos-las-clases-de-los-datos">Miramos las clases de los datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datos)<span class="co">#proporciona información sobre la estructura del objeto, mostrando el tipo de datos de cada columna, la cantidad de elementos en cada columna.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   768 obs. of  9 variables:
 $ Pregnancies             : int  6 1 8 1 0 5 3 10 2 8 ...
 $ Glucose                 : int  148 85 183 89 137 116 78 115 197 125 ...
 $ BloodPressure           : int  72 66 64 66 40 74 50 0 70 96 ...
 $ SkinThickness           : int  35 29 0 23 35 0 32 0 45 0 ...
 $ Insulin                 : int  0 0 0 94 168 0 88 0 543 0 ...
 $ BMI                     : num  33.6 26.6 23.3 28.1 43.1 25.6 31 35.3 30.5 0 ...
 $ DiabetesPedigreeFunction: num  0.627 0.351 0.672 0.167 2.288 ...
 $ Age                     : int  50 31 32 21 33 30 26 29 53 54 ...
 $ Outcome                 : int  1 0 1 0 1 0 1 0 1 1 ...</code></pre>
</div>
</div>
<p>La única variable que debemos de cambiar es <code>Outcome</code> a factor. Donde 1 es diebetes, y 0 es no diabetes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)<span class="co"># se llama a la columna OUTCOME la cual está contenida en la variable datos y luego con la función as.factor se convierte a la columna en un factor y por último se reemplaza a la columna original con una columna convertida en factor. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="análisis-estadístico-preliminar" class="level1">
<h1>Análisis estadístico preliminar</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos)<span class="co">#la función "dim! tiene el objetivo de devolver un vector con dos elementos, el primero hace referencia a un número de filas y el segundo al número de columnas del objeto. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 768   9</code></pre>
</div>
</div>
<p>Tenemos 768 filas y 9 columnas. Analicemos primero dos a dos las variables una por una</p>
<section id="histogramas" class="level3">
<h3 class="anchored" data-anchor-id="histogramas">Histogramas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>)<span class="co">#se crea el vector con el nombre L.plots el cual es un vector con una longitud de datos igual al númeor de columnas -1. </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#es un vector con una longitud de datos igual al númeor de columnas menos unos, es decir asigna el valor de los datos en la variable n1, </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#El bucle for revisa los datos y los recorre de j desde 1 hasta la cantidad máxima de n1. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mostrar los histogramas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="co">#Muestra los histogramas para cada variable, son 8 en total </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En lo particular la variable del pedigree se me hace importante, entonces vamos a realizar gráficos de dispersión</p>
<p>En realidad, una buena práctica es correlacionar todas contra todas…</p>
</section>
</section>
<section id="gráfico-de-dispersión" class="level1">
<h1>Gráfico de dispersión</h1>
<p>Este gráfico sirve para mostrar los valores de dos variables para el conjunto de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(datos,BMI,DiabetesPedigreeFunction)<span class="co"># Esta rfunción nos genera un gráfico de disperción de la variable datos, donde el eje X representa BMI y en el eje X se representa DiabetesPedigreeFunction. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'ggside':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sin embargo, esto puede ser un proceso tedioso… imaginad hacer 16 gráficas ! podemos condersarlo todo</p>
<p>Simplificación:</p>
</section>
<section id="matriz-de-correlación." class="level1">
<h1>Matriz de correlación.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1])<span class="co"># se utiliza un teste de correlación con el finde calcular las correlaciones entre la columna de datos desde 1 hasta n1. </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p<span class="co"># Se estraen los valores del objeto "obj.cor" los cuales representan la significancia estadística de las correlaciones calculadas. </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj <span class="co">#se crea una matriz booleana que selecciona la mitad superior de la matriz de valores p. </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj<span class="co"># se realiza un proceso similar al anterior pero para los valores p en la mitad inferior de la matriz. </span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="co"># se establece en 1 la diagonal principal de la matriz con los valores p, </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>) <span class="co"># visualización de la matriz de correlaciones </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La matriz de correlación <strong>muestra los valores de correlación, que miden el grado de relación lineal entre cada par de variables</strong>. Los valores de correlación se pueden ubicar entre -1 y +1. Si las dos variables tienden a aumentar o disminuir al mismo tiempo, el valor de correlación es positivo.</p>
<p>Ahora podemos proceder a hacer algo similar, con una serie de comparaciones dos a dos sobre las medias o medianas, sobre cada variable y la variable de interés.</p>
<p>Primero debemos aplicar una regresión linear con variable dependiente cada variable numérica y por la categórica. Es decir un t.test pero con el fin de ver los residuos, para ver la normalidad de éstos</p>
</section>
<section id="prueba-de-normalidad-de-shapiro--wilk" class="level1">
<h1>Prueba de normalidad de Shapiro- Wilk</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="co"># se ajusta un modelo de regresión lineal para cada columna de datos para el caso de que X es la varible predictoria y datos$Outcome es la variable de respuesta.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">lm</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome))<span class="sc">$</span>residuals),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      shapiro.test)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>p.norm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pregnancies

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.9389, p-value &lt; 2.2e-16


$Glucose

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.97511, p-value = 3.726e-10


$BloodPressure

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.81468, p-value &lt; 2.2e-16


$SkinThickness

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.92004, p-value &lt; 2.2e-16


$Insulin

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.77776, p-value &lt; 2.2e-16


$BMI

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.94359, p-value &lt; 2.2e-16


$DiabetesPedigreeFunction

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.84939, p-value &lt; 2.2e-16


$Age

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.88114, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Se aplica la prueba de normalidad de Shapiro- Wilk a los residuos de cada varible. </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Todos los resultados se documentan en la variable: p.norm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Todas las variables son no normales, tal como vemos en los histogramas.</p>
<p>type = “nonparametric” = Indica que se debe utilizar un enfoque no paramétrico para el análisis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Pregnancies,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#realiza un análisis de diferencias entre grupos en la variable categórica Outcome y la variable numérica Pregnancies</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Glucose,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co"># #realiza un análisis de diferencias entre grupos en la variable categórica Outcome y la variable numérica Glucose</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,BloodPressure,<span class="at">type =</span> <span class="st">"nonparametric"</span>)<span class="co"># #realiza un análisis de diferencias entre grupos en la variable categórica Outcome y la variable numérica BloodPressure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Insulin,<span class="at">type =</span> <span class="st">"nonparametric"</span>)<span class="co"># #realiza un análisis de diferencias entre grupos en la variable categórica Outcome y la variable numérica Insulin</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,BMI,<span class="at">type =</span> <span class="st">"nonparametric"</span>)<span class="co"># #realiza un análisis de diferencias entre grupos en la variable categórica Outcome y la variable numérica BMI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,DiabetesPedigreeFunction,<span class="at">type =</span> <span class="st">"nonparametric"</span>)<span class="co"># #realiza un análisis de diferencias entre grupos en la variable categórica Outcome y la variable numérica DiabetesPedigreeFunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Age,<span class="at">type =</span> <span class="st">"nonparametric"</span>)<span class="co"># #realiza un análisis de diferencias entre grupos en la variable categórica Outcome y la variable numérica Outcome</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="pca" class="level3">
<h3 class="anchored" data-anchor-id="pca">PCA</h3>
<p>Análisis de componentes principales sirve para reducir el número de variables de forma que pasemos a tener el mínimo número de nuevas variables y que representen a todas las antiguas variables de la forma más representativa posible.</p>
<p>El objetivo es crear un gráfico de dispersión de los componentes principales para los valores PC1 y PC2 utilizando la función ggplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)<span class="co">#resumen estadístico de los datos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :  0.0   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 30.5   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 79.8   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   :846.0   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> F) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#se realiza un análisis de componentes principales</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)<span class="co">#combinación de las variables categóricas con los datos </span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="co"># gráfico de dispersión de los componentes principales </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora vamos a ver si haciendo unas transformaciones esto cambia. Pero antes debemos de ver las variables sospechosas…</p>
<p>Pero de igual manera podemos escalar a ver si hay algun cambio…</p>
</section>
<section id="gráfico-de-dispersión-1" class="level3">
<h3 class="anchored" data-anchor-id="gráfico-de-dispersión-1">gráfico de dispersión</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)<span class="co">#resumen estadístico de los datos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :  0.0   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 30.5   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 79.8   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   :846.0   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># análisis de componente principales.</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="co"># se utiliza la librería ggplot2 para crear un gráfico de dispersión de las dos primeras componentes principales (PC1 y PC2)del análisis de PCA. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Contribuciones de las variables originales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_contrib</span>(pcx,<span class="st">"var"</span>)<span class="co"># aquí se visualiza las contribuciones de las variables originales </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Al parecer es la insulina la que está dando problemas</p>
<p>Se realiza un análisis de componentes principales excluyendo a los datos de insulina.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## indices a quitar</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">grep</span>(<span class="st">"insulin"</span>,<span class="at">ignore.case =</span> T,<span class="fu">colnames</span>(datos)),<span class="fu">ncol</span>(datos))<span class="co"># se crea el vector W en la cual se tiene los índices de las columas de insulina de los datos.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="sc">-</span>w],<span class="at">scale. =</span> F) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nuevo análisis de componente principales, peroe sta vez se exluye a los datos de insulina. </span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>De hecho la insulina, tenía un aspecto raro, como sesgado, ver gráficos de arriba. Vamos a transformala…</p>
<p>Se aplica la transformada logarítmica a la variable a Insulina.</p>
<p>La transformación logarítmica es útil para transformar distribuciones con sesgo positivo (con cola más larga hacia la derecha): la parte izquierda se expandirá, mientras que la derecha se comprimirá, favoreciendo que la curva resultante se ajuste mejor a una normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Insulin  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Insulin<span class="fl">+0.05</span>)<span class="co"># se suma 0.05 antes de aplicar el logaritmo con el fin de evitar tomar valoires cercanos o iguales a 0. </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)<span class="co"># nuevamente un resumen de los datos.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin            BMI        DiabetesPedigreeFunction      Age       
 Min.   :-2.996   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:-2.996   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 3.418   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 1.008   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.: 4.847   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   : 6.741   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nuevo análisis se componentes principales. </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)<span class="co">#Se combinan las columnas de los resultados de PCA. </span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="co">#nuevamente un gráfico de dispersión de componentes como el anterior pero aqui se transforman los datos de insulina.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Cambia ! Esto significa que no hemos quitado la infromacion de la insulina, solamente lo hemos transformado</p>
<p>Es decir, cambia si transformamos los datos…a partir de esto, podemos realizar de nuevo pruebas de diferencia de medianas, pero ahora lo veremos condensado..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)<span class="co"># se cargan los datos. </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)<span class="co">#conversión de la columna Outcome de datos en un factor.</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>datsc <span class="ot">&lt;-</span> <span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])<span class="co"># se estandarízan los datos numéricos   y se exluye la columna -ncol(datos) ya que esta columna se convirtió en un factor. Y se guarda en la variable datsc.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veamos las distribuciones de nuevo….</p>
</section>
<section id="nuevos-histogramas-después-de-la-tranformación-de-insulina" class="level2">
<h2 class="anchored" data-anchor-id="nuevos-histogramas-después-de-la-tranformación-de-insulina">Nuevos histogramas después de la tranformación de Insulina</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>)<span class="co"># lista vacía con una longitud igual al número de columnas en datos menos 1. </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span><span class="co"># </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))<span class="co">#Se crea el gráfico del histograma y se especifícan los intervalos del histograma. </span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1<span class="co"># guarda el gráfico de histograma generado en la posición j de la lista l.plots.</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>l.plots<span class="co"># esta lista contiene una serie de gráficos de histogramas generados para las columnas numéricas datos. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Curioso, los valores la insulina, han cambiado por la transformación en valor mas no la distribución, vamos a hacer unos arrelgos…</p>
<p>Al parecer la preñanza esta ligada a una esgala logaritmica de 2 Esto es otra cosa…</p>
</section>
<section id="histograma-para-la-variable-pregnacies" class="level2">
<h2 class="anchored" data-anchor-id="histograma-para-la-variable-pregnacies">Histograma para la variable “Pregnacies”</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)<span class="co">#Cargamos los datos</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)<span class="co"># se convierten los datos outcome a un factor.</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Pregnancies  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Pregnancies<span class="fl">+0.5</span>)<span class="co">#Se aplica la tranformación logarítmica para pregnacies sumando el 0.5 antes de aplicar el logaritmo. </span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(Pregnancies))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">hist</span>(datos<span class="sc">$</span>Pregnancies,<span class="at">plot=</span>F)<span class="sc">$</span>breaks)<span class="co">#Creación del histograma de la variable pregnacies </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Realizaremos lo mismo con la grosura de la piel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)<span class="co">#Cargamos los datos</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)<span class="co"># se convierten los datos outcome a un factor.</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>SkinThickness  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>SkinThickness<span class="fl">+0.5</span>)<span class="co">#Se aplica la tranformación logarítmica para SkinThickness sumando el 0.5 antes de aplicar el logaritmo. </span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(SkinThickness))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">hist</span>(datos<span class="sc">$</span>SkinThickness,<span class="at">plot=</span>F)<span class="sc">$</span>breaks)<span class="co">#Creación del histograma de la variable SkinThickness.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Tenemos algo raro, lo más posible sea por la obesidad…</p>
</section>
<section id="gráfico-de-dispersión-y-prueba-estadísticas-adecuadas." class="level2">
<h2 class="anchored" data-anchor-id="gráfico-de-dispersión-y-prueba-estadísticas-adecuadas.">Gráfico de dispersión y prueba estadísticas adecuadas.</h2>
<p>Para los valriables: “SkinThickness” y “BMI”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(datos,SkinThickness,BMI)<span class="co"># esta sección realiza una comparación estadística entre las variables "SkinThickness" y "BMI".</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Curioso ! al parecer los datos tienen valores nulos, los cuales solo están en las otras variables que no sean pregnancies. Vamos a quitarlos…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)<span class="co"># se cargan los datos.</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)],<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,x))<span class="co"># se reemplazan las columnas de cero en todas las columnas de datos a esepción de la primera y la novena columna. </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)<span class="co"># Se convierte la columna outcome a un factor con las modificaciones anteriores. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="vamos-a-quitar-estos-valores" class="level3">
<h3 class="anchored" data-anchor-id="vamos-a-quitar-estos-valores">vamos a quitar estos valores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos[<span class="fu">complete.cases</span>(datos),]<span class="co"># se eliminan todas las filas en datos. Solo se conservan las filas completas sin valores faltantes.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se redujo el data set a 392 observaciones…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Esta línea muestra una tabla de frecuencias de la variable "Outcome" en datos, lo que proporciona un recuento de los diferentes niveles o categorías presentes en esa columna.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
262 130 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>)<span class="co">#se crea una lista llamada l.plots con longitud igual al número de columnas en datos menos 1</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#itera sobre cada columna de datos (excepto la columna "Outcome") y realiza las siguientes operaciones</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)<span class="co">#calcula el histograma de la columna j</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)<span class="co"># crea un nuevo marco de datos datos.tmp que contiene los valores de la columna j de datos.</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))<span class="co">#Esta línea utiliza la función ggplot() del paquete ggplot2 para crear un gráfico de histograma. El eje x se establece como value (los valores de la columna j), y el relleno del histograma se basa en la columna "Outcome"</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>l.plots<span class="co"># se muestran los histogramas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora si podemos realizar las transfomraciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)],<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,x))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos[<span class="fu">complete.cases</span>(datos),]</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Insulin <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Insulin)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Pregnancies <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Pregnancies<span class="fl">+0.5</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>DiabetesPedigreeFunction <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>DiabetesPedigreeFunction)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>SkinThickness <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((datos<span class="sc">$</span>SkinThickness))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Glucose <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Glucose)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Age <span class="ot">&lt;-</span><span class="fu">log2</span>(datos<span class="sc">$</span>Age)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>l.plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Con las anteriores transformaciones vamos a realizar el PCA de nuevo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies         Glucose      BloodPressure    SkinThickness  
 Min.   :-0.6931   Min.   :4.025   Min.   : 24.00   Min.   :2.646  
 1st Qu.: 0.4055   1st Qu.:4.595   1st Qu.: 62.00   1st Qu.:4.583  
 Median : 0.9163   Median :4.779   Median : 70.00   Median :5.385  
 Mean   : 0.9590   Mean   :4.778   Mean   : 70.66   Mean   :5.305  
 3rd Qu.: 1.7047   3rd Qu.:4.963   3rd Qu.: 78.00   3rd Qu.:6.083  
 Max.   : 2.8622   Max.   :5.288   Max.   :110.00   Max.   :7.937  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :2.639   Min.   :18.20   Min.   :-2.4651          Min.   :4.392  
 1st Qu.:4.341   1st Qu.:28.40   1st Qu.:-1.3103          1st Qu.:4.524  
 Median :4.832   Median :33.20   Median :-0.7996          Median :4.755  
 Mean   :4.813   Mean   :33.09   Mean   :-0.8391          Mean   :4.882  
 3rd Qu.:5.247   3rd Qu.:37.10   3rd Qu.:-0.3754          3rd Qu.:5.170  
 Max.   :6.741   Max.   :67.10   Max.   : 0.8838          Max.   :6.340  
 Outcome
 0:262  
 1:130  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora vamos a realizar las pruebas de medianas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(<span class="fu">scale</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]),</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">lm</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome))<span class="sc">$</span>residuals),</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>      shapiro.test)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>p.norm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pregnancies

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.95146, p-value = 4.684e-10


$Glucose

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.9958, p-value = 0.3813


$BloodPressure

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99011, p-value = 0.009686


$SkinThickness

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99384, p-value = 0.1123


$Insulin

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99054, p-value = 0.0128


$BMI

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.97122, p-value = 5.374e-07


$DiabetesPedigreeFunction

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99456, p-value = 0.1796


$Age

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.93053, p-value = 1.561e-12</code></pre>
</div>
</div>
<p>Hemos conseguido la normalidad en solo dos variables, si fueran mas procederiamos con t test pero como no es asi, con test de Wilcoxon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">scale</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]),</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">wilcox.test</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome)<span class="sc">$</span>p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observamos que en una primera instancia ahora todas tienen diferencias significativas, esto tenemos que corregir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>p.adj <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p.norm,<span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Todas siguen siendo significativas, ahora vamos a ver cuales aumentan o disminyuen respecto las otras</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>datos.split <span class="ot">&lt;-</span> <span class="fu">split</span>(datos,datos<span class="sc">$</span>Outcome)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>datos.median <span class="ot">&lt;-</span> <span class="fu">lapply</span>(datos.split, <span class="cf">function</span>(x) <span class="fu">apply</span>(x[,<span class="sc">-</span><span class="fu">ncol</span>(x)],<span class="dv">2</span>,median))</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>toplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">medianas=</span><span class="fu">Reduce</span>(<span class="st">"-"</span>,datos.median)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>,<span class="at">p.values=</span>p.adj)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>toplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           medianas     p.values
Pregnancies              -0.3364722 8.957407e-05
Glucose                  -0.2957935 4.902429e-22
BloodPressure            -4.0000000 8.957407e-05
SkinThickness            -0.5484102 4.309442e-07
Insulin                  -0.4788534 3.241934e-13
BMI                      -3.3500000 2.574728e-07
DiabetesPedigreeFunction -0.2779529 8.957407e-05
Age                      -0.4005379 1.577456e-14</code></pre>
</div>
</div>
<p>Ahora Todos los valores son significativos respecto a la obesidad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>También podemos observar como cambian las relaciones segun la diabetes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[datos<span class="sc">$</span>Outcome<span class="sc">==</span><span class="dv">0</span>,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[datos<span class="sc">$</span>Outcome<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Es decir, existen correlaciones únicas de la obesidad y no obesidad, y existen otras correlaciones que son debidas a otros factores.</p>
</section>
</section>
</section>
<section id="particion-de-datos" class="level1">
<h1>Particion de datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelado" class="level1">
<h1>Modelado</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>glm.mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Outcome <span class="sc">~</span>.,<span class="at">data=</span>dat.train,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">predict</span>(glm.mod,dat.test,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">&gt;=</span><span class="fl">0.5</span>,<span class="st">"N"</span>,<span class="st">"D"</span>))</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 72 20
         N  6 20
                                          
               Accuracy : 0.7797          
                 95% CI : (0.6941, 0.8507)
    No Information Rate : 0.661           
    P-Value [Acc &gt; NIR] : 0.003409        
                                          
                  Kappa : 0.4625          
                                          
 Mcnemar's Test P-Value : 0.010787        
                                          
            Sensitivity : 0.9231          
            Specificity : 0.5000          
         Pos Pred Value : 0.7826          
         Neg Pred Value : 0.7692          
             Prevalence : 0.6610          
         Detection Rate : 0.6102          
   Detection Prevalence : 0.7797          
      Balanced Accuracy : 0.7115          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<p>LASSO</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>tuneGrid<span class="ot">=</span><span class="fu">expand.grid</span>(</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">.alpha=</span><span class="dv">0</span>,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">.lambda=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>trainControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># prSummary needs calculated class,</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">classProbs =</span> T)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> trainControl,<span class="at">tuneGrid=</span>tuneGrid,</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">metric=</span><span class="st">"Accuracy"</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(model,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]),dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 73 20
         N  5 20
                                         
               Accuracy : 0.7881         
                 95% CI : (0.7033, 0.858)
    No Information Rate : 0.661          
    P-Value [Acc &gt; NIR] : 0.00177        
                                         
                  Kappa : 0.4797         
                                         
 Mcnemar's Test P-Value : 0.00511        
                                         
            Sensitivity : 0.9359         
            Specificity : 0.5000         
         Pos Pred Value : 0.7849         
         Neg Pred Value : 0.8000         
             Prevalence : 0.6610         
         Detection Rate : 0.6186         
   Detection Prevalence : 0.7881         
      Balanced Accuracy : 0.7179         
                                         
       'Positive' Class : D              
                                         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>tuneGrid<span class="ot">=</span><span class="fu">expand.grid</span>(</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">.alpha=</span><span class="dv">1</span>,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">.lambda=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.0001</span>))</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>trainControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># prSummary needs calculated class,</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">classProbs =</span> T)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> trainControl,<span class="at">tuneGrid=</span>tuneGrid,</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">metric=</span><span class="st">"Accuracy"</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(model,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]),dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 72 23
         N  6 17
                                          
               Accuracy : 0.7542          
                 95% CI : (0.6665, 0.8288)
    No Information Rate : 0.661           
    P-Value [Acc &gt; NIR] : 0.018639        
                                          
                  Kappa : 0.3883          
                                          
 Mcnemar's Test P-Value : 0.002967        
                                          
            Sensitivity : 0.9231          
            Specificity : 0.4250          
         Pos Pred Value : 0.7579          
         Neg Pred Value : 0.7391          
             Prevalence : 0.6610          
         Detection Rate : 0.6102          
   Detection Prevalence : 0.8051          
      Balanced Accuracy : 0.6740          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(Outcome <span class="sc">~</span> .,<span class="at">data=</span>dat.train,<span class="at">laplace =</span> <span class="dv">0</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span><span class="fu">predict</span>(mdl,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)])</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 68 12
         N 11 27
                                         
               Accuracy : 0.8051         
                 95% CI : (0.722, 0.8722)
    No Information Rate : 0.6695         
    P-Value [Acc &gt; NIR] : 0.0007988      
                                         
                  Kappa : 0.5567         
                                         
 Mcnemar's Test P-Value : 1.0000000      
                                         
            Sensitivity : 0.8608         
            Specificity : 0.6923         
         Pos Pred Value : 0.8500         
         Neg Pred Value : 0.7105         
             Prevalence : 0.6695         
         Detection Rate : 0.5763         
   Detection Prevalence : 0.6780         
      Balanced Accuracy : 0.7765         
                                         
       'Positive' Class : D              
                                         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>lambda_use <span class="ot">&lt;-</span> <span class="fu">min</span>(model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda[model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda <span class="sc">&gt;=</span> model<span class="sc">$</span>bestTune<span class="sc">$</span>lambda])</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">which</span>(model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda <span class="sc">==</span> lambda_use)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>featsele <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">coef</span>(model<span class="sc">$</span>finalModel)[, position])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(featsele)[featsele<span class="sc">$</span>coef.model.finalModel....position.<span class="sc">!=</span><span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(Intercept)"              "Glucose"                 
[3] "BMI"                      "DiabetesPedigreeFunction"
[5] "Age"                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>mdl.sel <span class="ot">&lt;-</span><span class="fu">naiveBayes</span>(Outcome <span class="sc">~</span> Insulin<span class="sc">+</span>Glucose<span class="sc">+</span>DiabetesPedigreeFunction<span class="sc">+</span>Age,<span class="at">data =</span> dat.train)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl.sel,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)])</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 66 16
         N 13 23
                                          
               Accuracy : 0.7542          
                 95% CI : (0.6665, 0.8288)
    No Information Rate : 0.6695          
    P-Value [Acc &gt; NIR] : 0.02925         
                                          
                  Kappa : 0.4336          
                                          
 Mcnemar's Test P-Value : 0.71035         
                                          
            Sensitivity : 0.8354          
            Specificity : 0.5897          
         Pos Pred Value : 0.8049          
         Neg Pred Value : 0.6389          
             Prevalence : 0.6695          
         Detection Rate : 0.5593          
   Detection Prevalence : 0.6949          
      Balanced Accuracy : 0.7126          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">400</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">repeats =</span> <span class="dv">3</span>) <span class="co">#,classProbs=TRUE,summaryFunction = twoClassSummary)</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>knnFit <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"knn"</span>, <span class="at">trControl =</span> ctrl, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="at">tuneLength =</span> <span class="dv">50</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Output of kNN fit</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>knnFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

274 samples
  8 predictor
  2 classes: 'D', 'N' 

Pre-processing: centered (8), scaled (8) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 247, 247, 247, 245, 247, 247, ... 
Resampling results across tuning parameters:

  k    Accuracy   Kappa    
    5  0.7208691  0.3469526
    7  0.7462689  0.4058396
    9  0.7571155  0.4187608
   11  0.7728121  0.4560914
   13  0.7678769  0.4417864
   15  0.7654108  0.4323795
   17  0.7689822  0.4358577
   19  0.7641762  0.4231568
   21  0.7677948  0.4313355
   23  0.7616189  0.4132391
   25  0.7654108  0.4229062
   27  0.7579593  0.4028430
   29  0.7640470  0.4188210
   31  0.7641762  0.4156285
   33  0.7630299  0.4107392
   35  0.7617542  0.4069714
   37  0.7629888  0.4123389
   39  0.7629417  0.4116769
   41  0.7737472  0.4383776
   43  0.7786855  0.4519207
   45  0.7665572  0.4170320
   47  0.7580916  0.3937502
   49  0.7531974  0.3788627
   51  0.7592380  0.3959174
   53  0.7580475  0.3930130
   55  0.7532415  0.3753600
   57  0.7434531  0.3532964
   59  0.7434531  0.3547546
   61  0.7506842  0.3755523
   63  0.7556665  0.3871234
   65  0.7531974  0.3796594
   67  0.7544320  0.3793427
   69  0.7568129  0.3861968
   71  0.7569011  0.3872332
   73  0.7569452  0.3857141
   75  0.7556665  0.3819716
   77  0.7520069  0.3703039
   79  0.7532415  0.3717625
   81  0.7605607  0.3860203
   83  0.7605607  0.3847790
   85  0.7580916  0.3767812
   87  0.7544320  0.3619021
   89  0.7520069  0.3562105
   91  0.7519628  0.3543813
   93  0.7519187  0.3536799
   95  0.7532826  0.3569424
   97  0.7532826  0.3577419
   99  0.7508575  0.3498477
  101  0.7458311  0.3303907
  103  0.7433619  0.3186492

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was k = 43.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(knnFit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>knnPredict <span class="ot">&lt;-</span> <span class="fu">predict</span>(knnFit,<span class="at">newdata =</span> dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)] )</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the confusion matrix to see accuracy value and other parameter values</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knnPredict, dat.test<span class="sc">$</span>Outcome )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 73 21
         N  6 18
                                          
               Accuracy : 0.7712          
                 95% CI : (0.6848, 0.8435)
    No Information Rate : 0.6695          
    P-Value [Acc &gt; NIR] : 0.010532        
                                          
                  Kappa : 0.4272          
                                          
 Mcnemar's Test P-Value : 0.007054        
                                          
            Sensitivity : 0.9241          
            Specificity : 0.4615          
         Pos Pred Value : 0.7766          
         Neg Pred Value : 0.7500          
             Prevalence : 0.6695          
         Detection Rate : 0.6186          
   Detection Prevalence : 0.7966          
      Balanced Accuracy : 0.6928          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>) </span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>ctrl<span class="ot">&lt;-</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">number=</span><span class="dv">10</span>,<span class="at">classProbs =</span> <span class="cn">TRUE</span>,<span class="at">summaryFunction =</span> twoClassSummary) </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>plsda<span class="ot">&lt;-</span><span class="fu">train</span>(<span class="at">x=</span>dat.train[,<span class="sc">-</span><span class="fu">ncol</span>(datos)], <span class="co"># spectral data</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>dat.train<span class="sc">$</span>Outcome, <span class="co"># factor vector</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"pls"</span>, <span class="co"># pls-da algorithm</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">tuneLength=</span><span class="dv">10</span>, <span class="co"># number of components</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">trControl=</span>ctrl, <span class="co"># ctrl contained cross-validation option</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">preProc=</span><span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="co"># the data are centered and scaled</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">metric=</span><span class="st">"ROC"</span>) <span class="co"># metric is ROC for 2 classes</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>plsda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Partial Least Squares 

537 samples
  8 predictor
  2 classes: 'D', 'N' 

Pre-processing: centered (8), scaled (8) 
Resampling: Cross-Validated (10 fold, repeated 1 times) 
Summary of sample sizes: 483, 484, 483, 483, 483, 483, ... 
Resampling results across tuning parameters:

  ncomp  ROC        Sens       Spec     
  1      0.8183485  0.8468067  0.5657895
  2      0.8348713  0.8667227  0.6181579
  3      0.8346068  0.8814286  0.6023684
  4      0.8342848  0.8756303  0.6076316
  5      0.8338425  0.8784874  0.6023684
  6      0.8336922  0.8784874  0.6023684
  7      0.8336922  0.8784874  0.6023684

ROC was used to select the optimal model using the largest value.
The final value used for the model was ncomp = 2.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsda,<span class="at">newdata =</span> dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   D   N
         D 135  40
         N  19  37
                                          
               Accuracy : 0.7446          
                 95% CI : (0.6833, 0.7995)
    No Information Rate : 0.6667          
    P-Value [Acc &gt; NIR] : 0.006419        
                                          
                  Kappa : 0.3833          
                                          
 Mcnemar's Test P-Value : 0.009220        
                                          
            Sensitivity : 0.8766          
            Specificity : 0.4805          
         Pos Pred Value : 0.7714          
         Neg Pred Value : 0.6607          
             Prevalence : 0.6667          
         Detection Rate : 0.5844          
   Detection Prevalence : 0.7576          
      Balanced Accuracy : 0.6786          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<p>Si tuneamos lambda</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="fl">0.1</span>)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(dat.train[,<span class="sc">-</span><span class="fu">ncol</span>(datos)],dat.train<span class="sc">$</span>Outcome)</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicciones,dat.test<span class="sc">$</span>Outcome)<span class="sc">$</span>overall[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Accuracy 
0.7705628 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>) </span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>ctrl<span class="ot">&lt;-</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">number=</span><span class="dv">10</span>,<span class="at">classProbs =</span> <span class="cn">TRUE</span>,<span class="at">summaryFunction =</span> twoClassSummary) </span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>plsda<span class="ot">&lt;-</span><span class="fu">train</span>(<span class="at">x=</span>dat.train[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>)], <span class="co"># spectral data</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>dat.train<span class="sc">$</span>Outcome, <span class="co"># factor vector</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"pls"</span>, <span class="co"># pls-da algorithm</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">tuneLength=</span><span class="dv">10</span>, <span class="co"># number of components</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">trControl=</span>ctrl, <span class="co"># ctrl contained cross-validation option</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">preProc=</span><span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="co"># the data are centered and scaled</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">metric=</span><span class="st">"ROC"</span>) <span class="co"># metric is ROC for 2 classes</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsda,dat.test[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>)])</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   D   N
         D 136  42
         N   9  44
                                         
               Accuracy : 0.7792         
                 95% CI : (0.7201, 0.831)
    No Information Rate : 0.6277         
    P-Value [Acc &gt; NIR] : 5.532e-07      
                                         
                  Kappa : 0.4876         
                                         
 Mcnemar's Test P-Value : 7.433e-06      
                                         
            Sensitivity : 0.9379         
            Specificity : 0.5116         
         Pos Pred Value : 0.7640         
         Neg Pred Value : 0.8302         
             Prevalence : 0.6277         
         Detection Rate : 0.5887         
   Detection Prevalence : 0.7706         
      Balanced Accuracy : 0.7248         
                                         
       'Positive' Class : D              
                                         </code></pre>
</div>
</div>
<p>Finalmente podríamos hacer un análisis de la varianza multivariante</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: permute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is vegan 2.6-4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'vegan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:caret':

    tolerance</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis2</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)] <span class="sc">~</span>datos<span class="sc">$</span>Outcome,<span class="at">method =</span> <span class="st">"euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = datos[, -ncol(datos)] ~ datos$Outcome, method = "euclidean")
               Df SumOfSqs      R2      F Pr(&gt;F)    
datos$Outcome   1    357.8 0.05831 47.434  0.001 ***
Residual      766   5778.2 0.94169                  
Total         767   6136.0 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Es decir, como conlusión aunque las variables no pueden detectar la diabetes, siendo variables independientes, si por otro lado las consideramos dependientes de la diabetes.</p>
<p>Es decir, la diabetes es una condición en la que influye en los parámetros, mientras que es menos probable que la diabetes sea la causa de estas alteraciones, con una mejor precisón del 77 por ciento.</p>
<p>Es decir, por un lado tenemos las variables que nos explican solo un 77 porciento de la diabetes, mientras que la condición en sí nos separa más entre la media global.</p>
<p>Se podría investigar más esto. Por ejemplo, se podría hacer una correlación parcial, dada la diabetes, e identificar aquellas variables especificamente relacionadas con esta.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>